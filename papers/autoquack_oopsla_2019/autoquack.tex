%For final camera-ready submission, w/ required CCS and ACM Reference
% \documentclass[acmsmall]{acmart}\settopmatter{}
\documentclass[acmsmall,screen]{acmart} 
% Anshuman is maintaining an issue list at
% https://docs.google.com/spreadsheets/d/11_lN7I7RnIjRcRAW_zyK4x03sH7-aA9oEyiyhlPlxP0/edit?usp=sharing

%% Conference information
%% Supplied to authors by publisher for camera-ready submission;
%% use defaults for review submission.
%% \acmConference[OOPSLA '19]{Proceedings of the ACM on Programming Languages, Volume 3, Number OOPSLA}{October 20â€“25, 2019}{Athens, Greece}
%% \acmISBN{} % \acmISBN{978-x-xxxx-xxxx-x/YY/MM}
\startPage{1}

%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission;
%% use 'none' for review submission.
% \setcopyright{none}
%% \setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
\setcopyright{rightsretained}
\acmPrice{}
\acmDOI{10.1145/3360597}
\acmYear{2019}
\copyrightyear{2019}
\acmJournal{PACMPL}
\acmVolume{3}
\acmNumber{OOPSLA}
\acmArticle{171}
\acmMonth{10}

%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
\citestyle{acmauthoryear}  %% For author/year citations
%\citestyle{acmnumeric}     %% For numeric citations
%\setcitestyle{nosort}      %% With 'acmnumeric', to disable automatic
                            %% sorting of references within a single citation;
                            %% e.g., \cite{Smith99,Carpenter05,Baker12}
                            %% rendered as [14,5,2] rather than [2,5,14].
%\setcitesyle{nocompress}   %% With 'acmnumeric', to disable automatic
                            %% compression of sequential references within a
                            %% single citation;
                            %% e.g., \cite{Baker12,Baker14,Baker16}
                            %% rendered as [2,3,4] rather than [2-4].


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Note: Authors migrating a paper from traditional SIGPLAN
%% proceedings format to PACMPL format must update the
%% '\documentclass' and topmatter commands above; see
%% 'acmart-pacmpl-template.tex'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Some recommended packages.
%\usepackage{booktabs}   %% For formal tables:
                        %% http://ctan.org/pkg/booktabs
%\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
                        %% http://ctan.org/pkg/subcaption

\usepackage{listings}          % for code formatting
\usepackage{stmaryrd}          % for the lightning symbol
\usepackage{mathtools}         % for mathrlap
\usepackage{semantic}          % for mathlig
\usepackage{mathpartir}        % for inferrule
\usepackage{tikz}              % for drawings
\usepackage{courier}           % for the courier font (optional)
\usepackage{multicol}          % for multi-column listings
\usepackage{subcaption}        % for subfigures
\usepackage[export]{adjustbox} % for subfigures
\usepackage{accents}
\usepackage{wrapfig}
\usepackage{scalerel}
\usepackage{graphicx}
\usepackage{fvextra}

\renewcommand*{\ttdefault}{zi4}

% inline code
\makeatletter
\newlength{\@mli}
\newcommand{\mli}[1]{%
  \settowidth{\@mli}{\lstinline/#1/}
  \hspace{-.5ex}\begin{minipage}[t]{\@mli}\lstinline/#1/\end{minipage}}
\newcommand{\ostar}{\mathbin{\mathpalette\make@circled\ast}}
\newcommand{\make@circled}[2]{%
  \ooalign{$\m@th#1\smallbigcirc{#1}$\cr\hidewidth$\m@th#1#2$\hidewidth\cr}%
}
\newcommand{\smallbigcirc}[1]{%
  \vcenter{\hbox{\scalebox{0.66667}{$\m@th#1\bigcirc$}}}%
}
\makeatother

% \newcommand{\note}[2][polish]{{\color{red} #2 }{\marginpar{\tiny \color{blue} #1 }}}
% \newcommand{\noted}[2][new]{{\color{orange} #2 }{\marginpar{\tiny \color{blue} #1 }}}
% \newcommand{\notedd}[2][blah]{#2}
%% \newcommand{\li}[1]{\ifmmode\mbox{\mli{#1}}\else\mbox{\lstinline/#1/}\fi}
\newcommand{\li}[1]{{\texttt{\small #1}}}
\newcommand\hide[1]{}
\newcommand{\MV}{\ensuremath{\mathsf{ModVar}}}
\newcommand{\FV}{\ensuremath{\mathsf{FreeVar}}}
\newcommand{\pguards}[1]{\llbracket #1 \rrbracket}
\newcommand{\reachable}[5]{\ensuremath{{\m{#1}\;\accentset{#2}{\leadsto}^{#3}_{#4} \m{#5}}}}

%\newcommand{\scon}{\mathbin{\varstar}}
\newcommand{\minbar}{\scalebox{1.0}[1.0]{$-$}}
\newcommand{\scon}{\mathbin{\star}}
\renewcommand{\scon}{\mathbin{\ast}} % Comment out this line to return to 5-pt star
\renewcommand{\bigstar}{\raisebox{-0.24em}{{\scaleobj{2.5}{\scon}}}}
\newcommand{\ocon}{
  \mathbin{\mbox{$\mathrlap{\cup}\hspace*{.09em}
      \raisebox{.04em}[0ex][0ex]{$\scon$}$\hspace*{.07em}}}}
\newcommand{\bigocon}{\raisebox{-0.3ex}{\resizebox{0.75em}{!}{\hspace{0.05em}$\scon$}}\hspace{-2.18ex} \bigcup}
\newcommand{\wand}{%
 \mathrel{\mbox{$\hspace*{-0.03em}\mathord{-}\hspace*{-0.4em}
  \mathord{-}\hspace*{-0.13em}
     \mathord{\scon}$\hspace*{-0.005em}}}}
\newcommand{\septraction}{%
  \mathrel{\mbox{$\hspace*{-0.03em}\mathord{-}\hspace*{-0.66em}
  \mathord{-}\hspace*{-0.1em}\mathord{\ostar}$\hspace*{0.05em}}}}
\colorlet{red}{red!80!black}
\colorlet{lightgray}{gray!20!white}
\newcommand{\vdashtwo}{\vdash\hspace*{-0.5em}\mathord{-}}
\newcommand{\finf}{finf}
\newcommand{\tinf}{tinf}
\newcommand{\out}{out}
\newcommand{\braces}[1]{\left\{\!\!\!\begin{array}{l@{}} #1 \end{array}\right\}}
\newcommand{\ga}{\gamma}
\newcommand{\Eg}{E_\ga}
\newcommand{\Vg}{V_\ga}

\let\magicwand\wand
\let\emptyset\varnothing
\mathlig{--*}{\mathrel{\magicwand}}
\mathlig{--o}{\mathrel{\septraction}}
\mathlig{|->}{\mathrel{\mapsto}} % tight points-to
\mathlig{<=>}{\mathrel{\Leftrightarrow}} % equivalence of expressions
\mathlig{==>}{\mathrel{\Rightarrow}} % meta implication
\mathlig{-|-}{\mathrel{\mathrlap{\dashv} \hspace*{0.15em} \vdash}} % entails
\mathlig{**}{\mathbin{\ocon}}
\mathlig{*}{\mathbin{\scon}}
\mathlig{/|}{\mathbin{\wedge}} % additive conjunction
\mathlig{|/}{\mathbin{\vee}} % additive disjunction
\mathlig{|-}{\mathrel{\vdashtwo}} % entails
\mathlig{|=}{\models} % models
\mathlig{//}{\color{black}{\sslash}} % listings comments

\newcommand{\defeq}{\mathbin{\stackrel{\triangle}{=}}}
% \newcommand{\defeq}{
%   \mathbin{\mbox{$\mathrlap{=}\hspace*{.09em}
%       \raisebox{0.5em}[0ex][0ex]{\resizebox{0.4em}{!}{$\triangle$}}$\hspace*{.07em}}}}
\newcommand{\tx}[1]{\text{#1}}
\newcommand{\p}[1]{\ensuremath{\mathsf{#1}}} % predicate font
\newcommand{\m}[1]{\ensuremath{\mathit{#1}}} % math font
\newcommand{\ma}[1]{\ensuremath{\mathcal{#1}}} % mathcal font
%\newcommand{\ramify}{\lightning}
\let\ramify\lightning
\newcommand{\infrulestyle}[1]{\textsc{#1}}
\newcommand{\infrule}[4]{\inferrule*[lab=\infrulestyle{#1},right=$\mathrlap{#4}$]{#2}{#3}}
\newcommand{\medocon}{
  \raisebox{-0.3ex}{\resizebox{0.63em}{!}{$\scon$}} \hspace{-2.05ex} \bigcup}
\newcommand{\triple}[3]{\{#1\}\,#2\,\{#3\}}
\newcommand{\hl}[1]{\colorbox{lightgray}{#1}}

\lstset{%
  language=C,
  %morecomment=[n][{\color{red}}]{/*}{*/},
  morecomment=[l][{\color{red}}]{//},
  sensitive=true, mathescape=true, showlines=true, escapechar=`,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\color{blue}, numbers=left,
  numberstyle=\tiny, numbersep=5pt, boxpos=t,
  showstringspaces=false
}
% \long\def\beginpgfgraphicnamed#1#2\endpgfgraphicnamed{\includegraphics{#1}}
\usetikzlibrary{arrows.meta, positioning, decorations.pathmorphing, fit}

\begin{document}

%% Title information
\title[Certifying Graph-Manipulating Programs]
{Certifying Graph-Manipulating C Programs via~Localizations within Data Structures}
                                        %% [Short Title] is optional;
                                        %% when present, will be used in
                                        %% header instead of Full Title.
%\titlenote{with title note}            %% \titlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'
%\subtitle{Subtitle}                    %% \subtitle is optional
%\subtitlenote{with subtitle note}      %% \subtitlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'


%% Author information
%% Contents and number of authors suppressed with 'anonymous'.
%% Each author should be introduced by \author, followed by
%% \authornote (optional), \orcid (optional), \affiliation, and
%% \email.
%% An author may have multiple affiliations and/or emails; repeat the
%% appropriate command.
%% Many elements are not rendered, but should be provided for metadata
%% extraction tools.

%% Author with single affiliation.
\author[S. Wang]{Shengyi Wang}
\affiliation{\institution{School of Computing, National University of Singapore}}

\author[Q. Cao]{Qinxiang Cao}
\affiliation{\institution{John Hopcroft Center, Shanghai Jiao Tong University}}
% \email{caoqinxiang@gmail.com}

\author[A. Mohan]{Anshuman Mohan}
\affiliation{\institution{Yale-NUS College and School of Computing, National University of Singapore}}
% \email{anshumanmohan@live.com}

\author[A. Hobor]{Aquinas Hobor}
\affiliation{\institution{Yale-NUS College and School of Computing, National University of Singapore}}

% \email{aquinashobor@live.com}

%% Abstract
%% Note: \begin{abstract}...\end{abstract} environment must come
%% before \maketitle command
\begin{abstract}
%\marginpar{\tiny \color{red}23p lim}
We develop powerful and general techniques to mechanically verify realistic programs that
manipulate heap-represented graphs.  These graphs can exhibit well-known organization 
principles, such as being a directed acyclic graph or a disjoint-forest; alternatively, these graphs can 
be totally unstructured.  The common thread for such structures is that they exhibit deep 
intrinsic sharing and can be expressed using the language of graph theory. 
We construct a modular and general setup for reasoning about abstract mathematical
graphs and use separation logic to define how such abstract graphs are represented concretely in
the heap. We develop a \infrulestyle{Localize} rule that enables modular reasoning
about such programs, and show how this rule can support existential
quantifiers in postconditions and smoothly handle modified program variables.
We demonstrate the generality and power of our techniques by integrating them into 
the Verified Software Toolchain and certifying the correctness of seven graph-manipulating 
programs written in CompCert C, including
a 400-line generational garbage collector for the CertiCoq project.
While doing so, we identify
two places where the semantics of C is too weak to define generational
garbage collectors of the
sort used in the OCaml runtime.  Our proofs are entirely machine-checked in Coq.
%We connect our development to two large verification tools, and HIP/SLEEK, and use these tools to mechanically verify several canonical graph algorithms. %
\end{abstract}

%% 2012 ACM Computing Classification System (CSS) concepts
%% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10003752.10003790.10011742</concept_id>
<concept_desc>Theory of computation~Separation logic</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010138.10010142</concept_id>
<concept_desc>Theory of computation~Program verification</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003752.10003790.10002990</concept_id>
<concept_desc>Theory of computation~Logic and verification</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10003752.10010124.10010138.10010140</concept_id>
<concept_desc>Theory of computation~Program specifications</concept_desc>
<concept_significance>100</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Theory of computation~Separation logic}
\ccsdesc[500]{Theory of computation~Program verification}
\ccsdesc[300]{Theory of computation~Logic and verification}
\ccsdesc[100]{Theory of computation~Program specifications}

%% End of generated code


%% Keywords
%% comma separated list
\keywords{Separation logic, Graph-manipulating programs, Coq, CompCert, VST}  %% \keywords are mandatory in final camera-ready submission


%% \maketitle
%% Note: \maketitle command must come after title commands, author
%% commands, abstract environment, Computing Classification System
%% environment and commands, and keywords command.
\maketitle

\section{Introduction}
\label{sec:intro}
\input{intro.tex}

\section{Tour of a verified example}
\label{sec:orientation}
\input{orientation.tex}

\section{Linking Existentials in Localizations}
\label{sec:localizations}
\input{localizations.tex}

\section{A Reusable Library of Formalized Graph Theory}
\label{sec:mathgraph}
\input{math_graph.tex}

\section{Defining and reasoning about spatial graphs}
\label{sec:spacegraph}
\input{spatial.tex}

\section{Certifying a Garbage Collector for CertiCoq}
\label{sec:certigc}
\input{certigc.tex}

\section{Engineering our Techniques}
\label{sec:development}
\input{development.tex}

\section{Related work}
\label{sec:related}
\input{related.tex}

\section{Future work and conclusion}
\label{sec:future}
\label{sec:conclusion}
\input{futurecon.tex}

%% Acknowledgments
\begin{acks}
We thank Asankhaya Sharma for his help with a previous version of this paper,
Neel Krishnaswami for his helpful suggestions and encouragements, and 
Xavier Leroy and Robbert Krebbers for fruitful discussions. 
We also thank the CertiCoq team (esp. Andrew~W.~Appel, Olivier~Savary~Belanger, and 
Zoe~Paraskevopoulou) for their overall support and for hosting 
Shengyi Wang for a summer. This work was funded in part by the
\grantsponsor{}{Yale-NUS College}{} grant~\mbox{\grantnum{}{R-607-265-322-121}}, the \grantsponsor{}{National Science Foundation}{} grant~\grantnum{}{CCF-1521602}, and 
the \grantsponsor{}{Shanghai Pujiang Program}{} grant~\grantnum{}{19PJ1406000}.
Any opinions, findings, and conclusions or recommendations expressed in 
this material are those of the authors and do not necessarily reflect the 
views of Yale-NUS College, the National Science Foundation, or the Shanghai Pujiang Program.
\hide{

                            %% acks environment is optional
                                        %% contents suppressed with 'anonymous'
  %% Commands \grantsponsor{<sponsorID>}{<name>}{<url>} and
  %% \grantnum[<url>]{<sponsorID>}{<number>} should be used to
  %% acknowledge financial support and will be used by metadata
  %% extraction tools.
  This material is based upon work supported by the
  \grantsponsor{GS100000001}{National Science
    Foundation}{http://dx.doi.org/10.13039/100000001} under Grant
  No.~\grantnum{GS100000001}{nnnnnnn} and Grant
  No.~\grantnum{GS100000001}{mmmmmmm}.  Any opinions, findings, and
  conclusions or recommendations expressed in this material are those
  of the author and do not necessarily reflect the views of the
  National Science Foundation.}
\end{acks}

\pagebreak
\bibliography{autoquack}


%% Appendix
%\appendix
%\section{Appendix}
%\label{sec:appendix}
% \input{appendix.tex}  % riddled with overful boxes

\end{document}
